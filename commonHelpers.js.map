{"version":3,"file":"commonHelpers.js","sources":["../src/img/rejectedIcon.svg","../src/img/izitoast-close.svg","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__e571c120__\"","export default \"__VITE_ASSET__40276dd1__\"","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport rejectedIcon from './img/rejectedIcon.svg';\nimport closeIcon from './img/izitoast-close.svg';\n\nclass Spinner {\n  constructor(parentElemQuery) {\n    this.parent = parentElemQuery;\n  }\n\n  /**\n   * @description Adds a spinner to the page.\n   */\n\n  add() {\n    document.querySelector(this.parent).innerHTML =\n      '<div id=\"spinner-container\" style=\"padding-top: 25px; display:flex; flex-direction:column; gap:15px; align-items:center;\"><span class=\"js-processing-request\">Loading images, please wait...</span><span class=\"loader\"></span></div>';\n  }\n\n  /**\n   * @description Removes previously added spinner from the page.\n   */\n\n  remove() {\n    document.querySelector(this.parent).innerHTML = '';\n  }\n}\n\n/**\n * @param {array} data Expects an array of objects containing image data.\n * @param {string} parentElemQuery Expects a string containing DOM element query (class, id, etc).\n * @param {array} imgProperties Expects an array of three image properties to look for in data (largeImageURL, thumbnailURL, altText).\n * @param {array} descProperties Expects an array of additional description properties to look for in data (downloads, size, comments, etc).\n * @param {boolean} showDetails Expects a boolean value to render detailed information or not.\n */\n\nclass Gallery {\n  #markup;\n  #imgProperties;\n  #descProperties;\n  #imgData;\n  #descData;\n  #showDetails;\n\n  constructor(\n    data = [],\n    parentElemQuery = '',\n    imgProperties = [],\n    descProperties = [],\n    showDetails\n  ) {\n    this.rawData = data;\n    this.parent = parentElemQuery;\n    this.#imgProperties = imgProperties;\n    this.#descProperties = descProperties;\n    this.#showDetails = showDetails;\n    this.#imgData = this.#dataFilter(this.rawData, this.#imgProperties);\n    this.#descData = this.#dataFilter(this.rawData, this.#descProperties);\n    this.#markup = this.#createMarkup(this.#imgData, this.#descData);\n  }\n\n  /**\n   * @param {string} userInput Expects string value for testing.\n   * @returns {boolean} Returns true or false.\n   */\n\n  static testInput(userInput) {\n    if (!userInput.trim()) {\n      return false;\n    }\n    return /^[a-z\\s]+$/gi.test(userInput.trim());\n  }\n\n  /**\n   * @param {string} result Accepts one of two strings: 'wrong input' | 'nothing found'.\n   * @description Displays a popup area providing user with a feedback from the app.\n   */\n\n  static showPopup(result) {\n    const options = {\n      class: 'js-izitoast-message',\n      titleColor: '#FFFFFF',\n      messageColor: '#FFFFFF',\n      message:\n        result === 'wrong input'\n          ? 'Try something like \"kitty\", \"best friends\", \"on the Moon\" ;)'\n          : 'Sorry, there are no images matching your search query. Please try again!',\n      backgroundColor: result === 'wrong input' ? '#e0c34c' : '#ef4040',\n      progressBarColor: result === 'wrong input' ? '#f7e28b' : '#b51b1b',\n      messageSize: '16px',\n      position: 'topRight',\n      displayMode: 'replace',\n      pauseOnHover: false,\n      iconUrl: rejectedIcon,\n      close: false,\n\n      buttons: [\n        [\n          `<button type=\"button\" style=\"background-color: transparent;\"><img src=${closeIcon}></button>`,\n          function (instance, toast) {\n            instance.hide({ transitionOut: 'fadeOut' }, toast);\n          },\n        ],\n      ],\n      onOpening: function (_, toast) {\n        refs.container.innerHTML = '';\n        refs.input.blur();\n        refs.input.addEventListener(\n          'focus',\n          () => {\n            iziToast.hide({ transitionOut: 'fadeOut' }, toast);\n          },\n          { once: true }\n        );\n      },\n      onClosed: function (_, toast) {\n        refs.input.removeEventListener(\n          'focus',\n          () => {\n            iziToast.hide({ transitionOut: 'fadeOut' }, toast);\n          },\n          { once: true }\n        );\n      },\n    };\n    iziToast.show(options);\n  }\n\n  /**\n   * @param {array} data Expects an array of objects of raw data as a result of fetch operation.\n   * @param {array} propsList Expects an array of strings indicating which properties to filter out of raw data.\n   * @returns {object} Returns an array of objects with requested properties only.\n   */\n\n  #dataFilter(data, propsList) {\n    return data.map(obj => {\n      const filtered = {};\n      propsList.forEach(keyName => {\n        filtered[keyName] = obj[keyName];\n      });\n      return filtered;\n    });\n  }\n\n  /**\n   * @param {array} img Expects an array of objects containing information related to each image, and alternative text to be shown.\n   * @param {array} desc Expects an array of objects containing information related to each image description.\n   * @returns {string} Returns a ready for use markup with or without image description.\n   */\n\n  #createMarkup(img, desc) {\n    const imgDesc = this.#showDetails\n      ? desc.map(\n          x =>\n            `<ul class=\"js-item-desc\">\n            <li class=\"js-desc-wrapper\">\n              <span class=\"js-desc-prop\">Likes</span>\n              <span class=\"js-desc-value\">${x.likes}</span>\n            </li>\n            <li class=\"js-desc-wrapper\">\n              <span class=\"js-desc-prop\">Views</span>\n              <span class=\"js-desc-value\">${x.views}</span>\n            </li>\n            <li class=\"js-desc-wrapper\">\n              <span class=\"js-desc-prop\">Comments</span>\n              <span class=\"js-desc-value\">${x.comments}</span>\n            </li>\n            <li class=\"js-desc-wrapper\">\n              <span class=\"js-desc-prop\">Downloads</span>\n              <span class=\"js-desc-value\">${x.downloads}</span>\n            </li>\n          </ul>`\n        )\n      : '';\n\n    const markup = img\n      .map(\n        (x, i) =>\n          `<li class=\"js-gallery-item\"><a class=\"js-image-container\" href=\"${\n            x.largeImageURL\n          }\"><img class=\"js-item-image\" src=\"${x.webformatURL}\" alt=\"${\n            x.tags\n          }\" /></a>${imgDesc ? imgDesc[i] : ''}</li>`\n      )\n      .join('\\n\\n');\n    return markup;\n  }\n\n  /**\n   * @description Adds new markup to the parent element.\n   */\n\n  render() {\n    document.querySelector(this.parent).innerHTML = this.#markup;\n    const images = document.querySelectorAll('.js-item-image');\n    images.forEach((x, i) =>\n      x.addEventListener('load', () => {\n        document\n          .querySelectorAll('.js-gallery-item')\n          [i].classList.add('visible');\n      })\n    );\n  }\n}\n\n////////////////////////////////////////////////////////////////////////\n\nconst refs = {\n  form: document.querySelector('.js-search-form'),\n  input: document.querySelector('.js-search-input'),\n  container: document.querySelector('.js-gallery'),\n  checkbox: document.querySelector('.js-search-checkbox'),\n};\n\nconst requestUrl = 'https://pixabay.com/api/';\n\nconst requestParams = {\n  key: '42242477-df8643eaa45736c853493b589',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  q: null,\n};\n\nconst spinner = new Spinner('.js-gallery');\n\nrefs.form.addEventListener('submit', e => {\n  e.preventDefault();\n  requestParams.q = refs.input.value.trim();\n\n  if (!Gallery.testInput(refs.input.value.trim())) {\n    refs.form.classList.add('centered');\n    Gallery.showPopup('wrong input');\n    refs.form.reset();\n    return;\n  }\n  spinner.add();\n\n  fetch(`${requestUrl}?${new URLSearchParams(requestParams)}`)\n    .then(response => {\n      if (!response.ok) {\n        throw new Error('Something went wrong!');\n      }\n      return response.json();\n    })\n    .then(data => {\n      if (!data.hits.length) {\n        refs.form.classList.add('centered');\n        Gallery.showPopup('nothing found');\n        refs.form.reset();\n        return;\n      }\n      refs.form.classList.remove('centered');\n      const gallery = new Gallery(\n        data.hits,\n        '.js-gallery',\n        ['largeImageURL', 'webformatURL', 'tags'],\n        ['likes', 'views', 'comments', 'downloads'],\n        refs.checkbox.checked\n      );\n      const lightboxInstance = new SimpleLightbox('.js-gallery a', {\n        className: 'lightbox-wrapper',\n      });\n\n      spinner.remove();\n      gallery.render();\n      lightboxInstance.refresh();\n      refs.form.reset();\n    })\n    .catch(error => console.log(error));\n});\n\n// Код нижче був зроблений виключно у дослідницьких цілях\n\n// refs.input.addEventListener('input', e => {\n//   if (!/^[a-z\\s]+$/gi.test(e.target.value)) {\n//     setTimeout(() => {\n//       e.target.value = e.target.value.slice(0, -1);\n//     }, 100);\n//   }\n// });\n"],"names":["rejectedIcon","closeIcon","Spinner","parentElemQuery","Gallery","data","imgProperties","descProperties","showDetails","__privateAdd","_dataFilter","_createMarkup","_markup","_imgProperties","_descProperties","_imgData","_descData","_showDetails","__privateSet","__privateMethod","dataFilter_fn","__privateGet","createMarkup_fn","userInput","result","options","instance","toast","_","refs","iziToast","x","i","propsList","obj","filtered","keyName","img","desc","imgDesc","requestUrl","requestParams","spinner","e","response","gallery","lightboxInstance","SimpleLightbox","error"],"mappings":"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"}