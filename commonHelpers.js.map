{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/img/rejectedIcon.svg","../src/img/izitoast-close.svg","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios, { Axios } from 'axios';\n\nexport class FetchPixabay {\n  constructor(\n    id,\n    requestURL,\n    requestConfig,\n    imagePropsList = ['largeImageURL', 'webformatURL', 'tags'],\n    descPropsList = ['likes', 'views', 'comments', 'downloads']\n  ) {\n    this.id = id;\n    this.requestURL = requestURL;\n    this.requestConfig = requestConfig;\n    this.imagePropsList = imagePropsList;\n    this.descPropsList = descPropsList;\n    this.data;\n    this.imgData;\n    this.descData;\n  }\n\n  /**\n   * @method set() Allows to set manualy request parameters and lists of necessary data to be filtered out of server response.\n   * @param {string} [requestURL] Expects a string containing valid base URL required to perform a request.\n   * @param {{}} [requestConfig] Expects an object with valid request configuration.\n   * @param {[string]} imagePropsList Expects an array of strings specifying image properties to be filtered out of a raw data.\n   * @param {[string]} descPropsList Expects an array of strings specifying image description properties to be filtered out of a raw data.\n   */\n\n  set(requestURL, requestConfig, imagePropsList, descPropsList) {\n    this.requestURL = requestURL;\n    this.requestConfig = requestConfig;\n    this.imagePropsList = imagePropsList;\n    this.descPropsList = descPropsList;\n  }\n\n  /**\n   * @method getImagesData() Retrieves data from remote server using Axios module.\n   * @returns Writes retrieved data into the instance property 'data'.\n   */\n\n  async get() {\n    if (!this.requestURL || !this.requestConfig) return;\n\n    const data = async () =>\n      await axios.get(this.requestURL, {\n        params: this.requestConfig,\n      });\n\n    this.data = await data();\n    this.descData = this.#dataFilter(this.data.data.hits, this.descPropsList);\n    this.imgData = this.#dataFilter(this.data.data.hits, this.imagePropsList);\n  }\n\n  /**\n   * @param {array} propsList Expects an array of strings each specifying a property to be filtered out of a raw data.\n   * @returns {object} Returns a new array of objects with requested properties only.\n   */\n\n  #dataFilter(data, propsList) {\n    return data.map(obj => {\n      const filtered = {};\n      propsList.forEach(keyName => {\n        filtered[keyName] = obj[keyName];\n      });\n      return filtered;\n    });\n  }\n\n  /**\n   * @param {string} userInput Expects string value for testing.\n   * @returns {boolean} Returns true or false.\n   */\n\n  static testUserInput(userInput) {\n    if (!userInput.trim()) {\n      return false;\n    }\n    return /^[a-z\\s]+$/gi.test(userInput.trim());\n  }\n}\n","export default \"__VITE_ASSET__e571c120__\"","export default \"__VITE_ASSET__40276dd1__\"","import rejectedIcon from '../img/rejectedIcon.svg';\nimport closeIcon from '../img/izitoast-close.svg';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n/**\n * @class - Provides developer with static methods allowing to add and remove loading spinner.\n * @method add() - Adds a spinner as a child of body element.\n * @method remove() - Removes last added spinner.\n */\n\nexport class Spinner {\n  static markup;\n\n  constructor() {}\n\n  /**\n   * @description Adds a spinner to the page.\n   */\n\n  static add() {\n    const spinnerElem = document.createElement('button');\n    document.body.appendChild(spinnerElem);\n    spinnerElem.outerHTML = this.markup;\n  }\n\n  /**\n   * @description Removes previously added spinner from the page.\n   */\n\n  static remove() {\n    const spinnerElem = document.querySelector('#spinner-container');\n    document.body.removeChild(spinnerElem);\n  }\n}\n\n/**\n * @class - Use to hide or show your element. Requires at least one of CSS classes .visible | .hidden to be described in styles.css.\n */\n\nexport class Element {\n  constructor() {}\n\n  static show(elem) {\n    elem.classList.add('visible');\n  }\n\n  static hide(elem) {\n    elem.classList.remove('visible');\n  }\n\n  static isVisible(elem) {\n    return elem.classList.contains('visible');\n  }\n}\n\n/**\n * @param {string} parentElemQuery Expects a string containing DOM element query (class, id, etc).\n * @param {array} imgData Expects an array of three image properties to look for in data (largeImageURL, thumbnailURL, altText).\n * @param {array} descData Expects an array of additional description properties to look for in data (downloads, size, comments, etc).\n * @param {boolean} showDesc Expects a boolean value to render detailed information or not.\n */\n\nexport class Gallery {\n  constructor(\n    parentElemQuery = '',\n    imgData = null,\n    descData = null,\n    showDesc = document.querySelector('.js-loadmore-button') || true\n  ) {\n    this.parent = parentElemQuery;\n    this.imgData = imgData;\n    this.descData = descData;\n    this.showDesc = showDesc;\n    this.markup = this.#createMarkup(this.imgData, this.descData);\n  }\n\n  /**\n   * @param {string} result Accepts one of two strings: 'wrong input' | 'nothing found | 'sorry'.\n   * @description Displays a popup area providing user with a feedback from the app.\n   */\n\n  static showPopup(requestResult, inputElemQuery = 'input') {\n    const options = {\n      class: 'js-izitoast-message',\n      titleColor: '#FFFFFF',\n      messageColor: '#FFFFFF',\n      message:\n        requestResult === 'wrong input'\n          ? 'Try something like \"kitty\", \"best friends\", \"on the Moon\" ;)'\n          : requestResult === 'sorry'\n          ? \"We're sorry, but you've reached the end of search results.\"\n          : 'Sorry, there are no images matching your search query. Please try again!',\n      backgroundColor:\n        requestResult === 'wrong input'\n          ? '#e0c34c'\n          : requestResult === 'sorry'\n          ? '#278edd'\n          : '#ef4040',\n      progressBarColor:\n        requestResult === 'wrong input'\n          ? '#f7e28b'\n          : requestResult === 'sorry'\n          ? '#4eb2ff'\n          : '#b51b1b',\n      messageSize: '16px',\n      position: 'topRight',\n      displayMode: 'replace',\n      pauseOnHover: false,\n      iconUrl: rejectedIcon,\n      close: false,\n\n      buttons: [\n        [\n          `<button type=\"button\" style=\"background-color: transparent;\"><img src=${closeIcon}></button>`,\n          function (instance, toast) {\n            instance.hide({ transitionOut: 'fadeOut' }, toast);\n          },\n        ],\n      ],\n      onOpening: function (_, toast) {\n        const input = document.querySelector(inputElemQuery);\n        input.blur();\n        input.addEventListener(\n          'focus',\n          () => {\n            iziToast.hide({ transitionOut: 'fadeOut' }, toast);\n          },\n          { once: true }\n        );\n      },\n      onClosed: function (_, toast) {\n        const input = document.querySelector(inputElemQuery);\n        input.removeEventListener(\n          'focus',\n          () => {\n            iziToast.hide({ transitionOut: 'fadeOut' }, toast);\n          },\n          { once: true }\n        );\n      },\n    };\n    iziToast.show(options);\n  }\n\n  /**\n   * @param {array} imageData Expects an array of objects containing information related to each image, and alternative text to be shown.\n   * @param {array} descriptionData Expects an array of objects containing information related to each image description.\n   * @returns {string} Returns a ready for use markup with or without image description.\n   */\n\n  #createMarkup(imageData, descriptionData) {\n    const description = this.showDesc\n      ? descriptionData.map(\n          x =>\n            `<ul class=\"js-item-desc\">\n            <li class=\"js-desc-wrapper\">\n              <span class=\"js-desc-prop\">Likes</span>\n              <span class=\"js-desc-value\">${x.likes}</span>\n            </li>\n            <li class=\"js-desc-wrapper\">\n              <span class=\"js-desc-prop\">Views</span>\n              <span class=\"js-desc-value\">${x.views}</span>\n            </li>\n            <li class=\"js-desc-wrapper\">\n              <span class=\"js-desc-prop\">Comments</span>\n              <span class=\"js-desc-value\">${x.comments}</span>\n            </li>\n            <li class=\"js-desc-wrapper\">\n              <span class=\"js-desc-prop\">Downloads</span>\n              <span class=\"js-desc-value\">${x.downloads}</span>\n            </li>\n          </ul>`\n        )\n      : '';\n\n    const markup = imageData\n      .map(\n        (x, i) =>\n          `<li class=\"js-gallery-item\"><a class=\"js-image-container\" href=\"${\n            x.largeImageURL\n          }\"><img class=\"js-item-image\" src=\"${x.webformatURL}\" alt=\"${\n            x.tags\n          }\" /></a>${description ? description[i] : ''}</li>`\n      )\n      .join('\\n\\n');\n    return markup;\n  }\n\n  /**\n   * @description Adds new markup to the parent element.\n   */\n\n  render(imageElemQuery, galleryItemElemQuery) {\n    document.querySelector(this.parent).innerHTML += this.markup;\n\n    const images = document.querySelectorAll(imageElemQuery);\n\n    images.forEach((x, i) =>\n      x.addEventListener('load', () => {\n        document\n          .querySelectorAll(galleryItemElemQuery)\n          [i].classList.add('visible');\n      })\n    );\n  }\n}\n","import { FetchPixabay } from './js/pixabay-api';\nimport { Spinner } from './js/render-functions';\nimport { Element } from './js/render-functions';\nimport { Gallery } from './js/render-functions';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nasync function onclick(e) {\n  e.preventDefault();\n  try {\n    Element.hide(refs.loadmore);\n    Spinner.add();\n    if (e.type === 'submit') {\n      refs.container.innerHTML = '';\n      requestParams.config.q = refs.input.value.trim();\n      requestParams.config.page = 1;\n      if (!FetchPixabay.testUserInput(refs.input.value.trim())) {\n        Spinner.remove();\n        Gallery.showPopup('wrong input');\n        refs.form.reset();\n        return;\n      }\n    } else {\n      requestParams.config.page += 1;\n    }\n\n    await requestResult.get();\n    const imgData = requestResult.imgData;\n    const descData = requestResult.descData;\n    const totalHits = requestResult.data.data.totalHits;\n\n    if (!totalHits) {\n      Spinner.remove();\n      Gallery.showPopup('nothing found');\n      refs.form.reset();\n      return;\n    }\n\n    const gallery = new Gallery(\n      '.js-gallery',\n      imgData,\n      descData,\n      refs.checkbox.checked\n    );\n\n    const lightboxInstance = new SimpleLightbox('.js-gallery a', {\n      className: 'lightbox-wrapper',\n    });\n\n    Spinner.remove();\n    gallery.render('.js-item-image', '.js-gallery-item');\n    lightboxInstance.refresh();\n    refs.form.reset();\n\n    if (\n      totalHits - requestParams.config.per_page * requestParams.config.page >\n      15\n    ) {\n      Element.show(refs.loadmore);\n    } else {\n      Element.hide(refs.loadmore);\n      Gallery.showPopup('sorry');\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nconst refs = {\n  body: document.querySelector('body'),\n  form: document.querySelector('.js-search-form'),\n  input: document.querySelector('.js-search-input'),\n  container: document.querySelector('.js-gallery'),\n  checkbox: document.querySelector('.js-search-checkbox'),\n  loadmore: document.querySelector('.js-loadmore-button'),\n};\n\nconst vars = {\n  canLoadmore: false,\n};\n\nconst requestParams = {\n  url: 'https://pixabay.com/api/',\n  config: {\n    key: '42242477-df8643eaa45736c853493b589',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    q: null,\n    page: 1,\n    per_page: 15,\n  },\n};\n\nconst requestResult = new FetchPixabay(\n  1,\n  requestParams.url,\n  requestParams.config,\n  ['largeImageURL', 'webformatURL', 'tags'],\n  ['likes', 'views', 'comments', 'downloads']\n);\n\nElement.hide(refs.loadmore);\n\nSpinner.markup =\n  '<div id=\"spinner-container\" style=\"padding-top: 25px; display:flex; flex-direction:column; gap:15px; align-items:center;\"><span class=\"js-processing-request\">Loading images, please wait...</span><span class=\"loader\"></span></div>';\n\nrefs.form.addEventListener('submit', onclick);\nrefs.loadmore.addEventListener('click', onclick);\n"],"names":["FetchPixabay","id","requestURL","requestConfig","imagePropsList","descPropsList","__privateAdd","_dataFilter","data","axios","__privateMethod","dataFilter_fn","userInput","propsList","obj","filtered","keyName","rejectedIcon","closeIcon","Spinner","spinnerElem","__publicField","Element","elem","Gallery","parentElemQuery","imgData","descData","showDesc","_createMarkup","createMarkup_fn","requestResult","inputElemQuery","options","instance","toast","_","input","iziToast","imageElemQuery","galleryItemElemQuery","x","i","imageData","descriptionData","description","onclick","e","refs","requestParams","totalHits","gallery","lightboxInstance","SimpleLightbox","error"],"mappings":"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"}